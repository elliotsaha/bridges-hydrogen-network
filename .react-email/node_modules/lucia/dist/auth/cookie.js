import { serializeCookie } from "../utils/cookie.js";
export const DEFAULT_SESSION_COOKIE_NAME = "auth_session";
export const createSessionCookie = (session, options) => {
    const getExpiration = () => {
        if (session === null)
            return 0;
        if (options.expires) {
            return session.idlePeriodExpiresAt;
        }
        return new Date().getTime() + 1000 * 60 * 60 * 24 * 365; // + 1 year
    };
    return new Cookie(options.name ?? DEFAULT_SESSION_COOKIE_NAME, session?.sessionId ?? "", {
        ...options.attributes,
        httpOnly: true,
        expires: new Date(getExpiration()),
        secure: options.env === "PROD"
    });
};
export class Cookie {
    constructor(name, value, options) {
        this.name = name;
        this.value = value;
        this.attributes = options;
    }
    name;
    value;
    attributes;
    serialize = () => {
        return serializeCookie(this.name, this.value, this.attributes);
    };
}
